(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{4146:function(e,s,t){Promise.resolve().then(t.bind(t,227))},227:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return DashboardPage},dynamic:function(){return n}});var a=t(7437),r=t(5057),i=t(4033);let n="force-dynamic";function DashboardPage(){var e,s,t,n,l,o,d,c;let{user:u,signOut:h,loading:m}=(0,r.useAuth)(),x=(0,i.useRouter)(),handleSignOut=async()=>{try{await h(),x.push("/")}catch(e){console.error("Error signing out:",e)}};return m?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):u?(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("nav",{className:"bg-white shadow",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between h-16",children:[(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)("h1",{className:"text-xl font-semibold text-gray-900",children:"Property Management Dashboard"})}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("span",{className:"text-sm text-gray-700",children:["Welcome, ",(null===(e=u.profile)||void 0===e?void 0:e.first_name)||u.email]}),(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:(null===(s=u.profile)||void 0===s?void 0:s.role)||"guest"}),(0,a.jsx)("button",{onClick:handleSignOut,className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-md text-sm font-medium",children:"Sign Out"})]})]})})}),(0,a.jsx)("main",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:(0,a.jsx)("div",{className:"px-4 py-6 sm:px-0",children:(0,a.jsx)("div",{className:"border-4 border-dashed border-gray-200 rounded-lg p-8",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Welcome to your Dashboard"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:"Authentication system is working! You are successfully signed in."}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow max-w-md mx-auto",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"User Information"}),(0,a.jsxs)("dl",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("dt",{className:"text-gray-500",children:"Email:"}),(0,a.jsx)("dd",{className:"text-gray-900",children:u.email})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("dt",{className:"text-gray-500",children:"Role:"}),(0,a.jsx)("dd",{className:"text-gray-900",children:(null===(t=u.profile)||void 0===t?void 0:t.role)||"guest"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("dt",{className:"text-gray-500",children:"Name:"}),(0,a.jsx)("dd",{className:"text-gray-900",children:(null===(n=u.profile)||void 0===n?void 0:n.first_name)&&(null===(l=u.profile)||void 0===l?void 0:l.last_name)?"".concat(u.profile.first_name," ").concat(u.profile.last_name):"Not provided"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("dt",{className:"text-gray-500",children:"Phone:"}),(0,a.jsx)("dd",{className:"text-gray-900",children:(null===(o=u.profile)||void 0===o?void 0:o.phone)||"Not provided"})]})]})]}),(null===(d=u.profile)||void 0===d?void 0:d.role)==="owner"&&(0,a.jsx)("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:(0,a.jsx)("p",{className:"text-green-800",children:"\uD83C\uDF89 You have property owner access! You can manage properties, bookings, and more."})}),(null===(c=u.profile)||void 0===c?void 0:c.role)==="guest"&&(0,a.jsx)("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:(0,a.jsx)("p",{className:"text-blue-800",children:"\uD83D\uDC4B Welcome! You can browse and book properties as a guest."})})]})})})})]}):(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Access Denied"}),(0,a.jsx)("p",{className:"mt-2 text-gray-600",children:"Please sign in to access the dashboard."})]})})}},5057:function(e,s,t){"use strict";t.r(s),t.d(s,{AuthProvider:function(){return AuthProvider},useAuth:function(){return useAuth}});var a=t(7437),r=t(2265),i=t(1492),n=t(3082);(0,i.eI)("https://placeholder.supabase.co","placeholder-key",{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}});let createSupabaseClient=()=>(0,n.createClientComponentClient)();function convertDbUserProfile(e){return{id:e.id,first_name:e.first_name||void 0,last_name:e.last_name||void 0,phone:e.phone||void 0,role:e.role||"guest",avatar_url:e.avatar_url||void 0,preferences:e.preferences||{},created_at:e.created_at,updated_at:e.updated_at}}let AuthService=class AuthService{async signUp(e){let{email:s,password:t,firstName:a,lastName:r,phone:i,role:n="guest"}=e,{data:l,error:o}=await this.supabase.auth.signUp({email:s,password:t,options:{data:{first_name:a,last_name:r,phone:i,role:n}}});if(o)throw Error(o.message);return l}async signIn(e){let{email:s,password:t}=e,{data:a,error:r}=await this.supabase.auth.signInWithPassword({email:s,password:t});if(r)throw Error(r.message);return a}async signInWithProvider(e){let{data:s,error:t}=await this.supabase.auth.signInWithOAuth({provider:e,options:{redirectTo:"".concat(window.location.origin,"/auth/callback")}});if(t)throw Error(t.message);return s}async signOut(){let{error:e}=await this.supabase.auth.signOut();if(e)throw Error(e.message)}async getCurrentUser(){let{data:{user:e},error:s}=await this.supabase.auth.getUser();if(s||!e)return null;let{data:t}=await this.supabase.from("user_profiles").select("*").eq("id",e.id).single();return{id:e.id,email:e.email,profile:t?convertDbUserProfile(t):void 0}}async updateProfile(e,s){let{data:t,error:a}=await this.supabase.from("user_profiles").update(s).eq("id",e).select().single();if(a)throw Error(a.message);return t?convertDbUserProfile(t):null}async resetPassword(e){let{error:s}=await this.supabase.auth.resetPasswordForEmail(e,{redirectTo:"".concat(window.location.origin,"/auth/reset-password")});if(s)throw Error(s.message)}async updatePassword(e){let{error:s}=await this.supabase.auth.updateUser({password:e});if(s)throw Error(s.message)}onAuthStateChange(e){return this.supabase.auth.onAuthStateChange(async(s,t)=>{if(null==t?void 0:t.user){let s=await this.getCurrentUser();e(s)}else e(null)})}constructor(){this.supabase=createSupabaseClient()}};let l=new AuthService,o=(0,r.createContext)(void 0);function AuthProvider(e){let{children:s}=e,[t,i]=(0,r.useState)(null),[n,d]=(0,r.useState)(!0);(0,r.useEffect)(()=>{l.getCurrentUser().then(i).finally(()=>d(!1));let{data:{subscription:e}}=l.onAuthStateChange(e=>{i(e),d(!1)});return()=>e.unsubscribe()},[]);let signIn=async(e,s)=>{d(!0);try{await l.signIn({email:e,password:s});let t=await l.getCurrentUser();i(t)}catch(e){throw e}finally{d(!1)}},signUp=async e=>{d(!0);try{await l.signUp(e)}catch(e){throw e}finally{d(!1)}},signInWithProvider=async e=>{d(!0);try{await l.signInWithProvider(e)}catch(e){throw e}finally{d(!1)}},signOut=async()=>{d(!0);try{await l.signOut(),i(null)}catch(e){throw e}finally{d(!1)}},updateProfile=async e=>{if(!t)throw Error("No user logged in");try{let s=await l.updateProfile(t.id,e);s&&i({...t,profile:s})}catch(e){throw e}},resetPassword=async e=>{await l.resetPassword(e)};return(0,a.jsx)(o.Provider,{value:{user:t,loading:n,signIn,signUp,signInWithProvider,signOut,updateProfile,resetPassword},children:s})}function useAuth(){let e=(0,r.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},4033:function(e,s,t){e.exports=t(94)}},function(e){e.O(0,[881,971,472,744],function(){return e(e.s=4146)}),_N_E=e.O()}]);