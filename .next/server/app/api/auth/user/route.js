(()=>{var e={};e.id=420,e.ids=[420],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},1808:e=>{"use strict";e.exports=require("net")},5477:e=>{"use strict";e.exports=require("punycode")},2781:e=>{"use strict";e.exports=require("stream")},4404:e=>{"use strict";e.exports=require("tls")},7310:e=>{"use strict";e.exports=require("url")},9796:e=>{"use strict";e.exports=require("zlib")},8359:()=>{},3739:()=>{},3515:(e,r,t)=>{"use strict";t.r(r),t.d(r,{headerHooks:()=>x,originalPathname:()=>m,requestAsyncStorage:()=>l,routeModule:()=>c,serverHooks:()=>d,staticGenerationAsyncStorage:()=>p,staticGenerationBailout:()=>f});var s={};t.r(s),t.d(s,{GET:()=>GET,PATCH:()=>PATCH});var o=t(884),a=t(6132),i=t(6813),u=t(4596),n=t(5798);function convertDbUserProfile(e){return{id:e.id,first_name:e.first_name||void 0,last_name:e.last_name||void 0,phone:e.phone||void 0,role:e.role||"guest",avatar_url:e.avatar_url||void 0,preferences:e.preferences||{},created_at:e.created_at,updated_at:e.updated_at}}async function GET(){try{let e=(0,i.createRouteHandlerClient)({cookies:u.cookies}),{data:{user:r},error:t}=await e.auth.getUser();if(t||!r)return n.Z.json({error:"Unauthorized"},{status:401});let{data:s,error:o}=await e.from("user_profiles").select("*").eq("id",r.id).single();return o&&console.error("Profile fetch error:",o),n.Z.json({user:{id:r.id,email:r.email,profile:s?convertDbUserProfile(s):null}})}catch(e){return console.error("Auth API error:",e),n.Z.json({error:"Internal server error"},{status:500})}}async function PATCH(e){try{let r=(0,i.createRouteHandlerClient)({cookies:u.cookies}),{data:{user:t},error:s}=await r.auth.getUser();if(s||!t)return n.Z.json({error:"Unauthorized"},{status:401});let o=await e.json(),{data:a,error:c}=await r.from("user_profiles").update(o).eq("id",t.id).select().single();if(c)return n.Z.json({error:c.message},{status:400});return n.Z.json({profile:a?convertDbUserProfile(a):null})}catch(e){return console.error("Profile update error:",e),n.Z.json({error:"Internal server error"},{status:500})}}let c=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/auth/user/route",pathname:"/api/auth/user",filename:"route",bundlePath:"app/api/auth/user/route"},resolvedPagePath:"/Users/emmanuelbukenya/Projects/Medical Rentals/medical-rentals/app/api/auth/user/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:l,staticGenerationAsyncStorage:p,serverHooks:d,headerHooks:x,staticGenerationBailout:f}=c,m="/api/auth/user/route"}};var r=require("../../../../webpack-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),t=r.X(0,[657,736],()=>__webpack_exec__(3515));module.exports=t})();