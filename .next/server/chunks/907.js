exports.id=907,exports.ids=[907],exports.modules={8359:()=>{},3739:()=>{},7711:(e,t,a)=>{"use strict";a.d(t,{h:()=>l});var r=a(699),i=a(2191);let s={apiKey:process.env.NEXT_PUBLIC_GOOGLE_MAPS_API_KEY||"",version:"weekly",libraries:["places","geometry"]},o=null;function getGoogleMapsLoader(){if(!o){if(!s.apiKey)throw Error("Google Maps API key is not configured");o=new i.aN(s)}return o}async function loadGoogleMaps(){let e=getGoogleMapsLoader();return await e.load()}async function geocodeAddress(e){try{let t=await loadGoogleMaps(),a=new t.maps.Geocoder,r=await new Promise((t,r)=>{a.geocode({address:e},(e,a)=>{"OK"===a&&e&&e.length>0?t(e):r(Error(`Geocoding failed: ${a}`))})}),i=r[0].geometry.location;return{lat:i.lat(),lng:i.lng(),formatted_address:r[0].formatted_address}}catch(e){return console.error("Geocoding error:",e),null}}async function calculateDistance(e,t){try{let a=await loadGoogleMaps(),r=new a.maps.DistanceMatrixService,i=await new Promise((i,s)=>{r.getDistanceMatrix({origins:[new a.maps.LatLng(e.lat,e.lng)],destinations:[new a.maps.LatLng(t.lat,t.lng)],travelMode:a.maps.TravelMode.DRIVING,unitSystem:a.maps.UnitSystem.IMPERIAL,avoidHighways:!1,avoidTolls:!1},(e,t)=>{"OK"===t&&e?i(e):s(Error(`Distance calculation failed: ${t}`))})}),s=i.rows[0]?.elements[0];if(s&&"OK"===s.status){let e=s.distance?.text||"";s.duration?.text;let t=parseFloat(e.replace(/[^\d.]/g,"")),a=Math.round(s.duration?.value?s.duration.value/60:0);return{distance_miles:t,drive_time_minutes:a}}return null}catch(e){return console.error("Distance calculation error:",e),null}}let n=[{id:"our-lady-of-the-lake",name:"Our Lady of the Lake Regional Medical Center",address:"5000 Hennessy Blvd, Baton Rouge, LA 70808",coordinates:{lat:30.4118,lng:-91.1258},type:"general",phone:"(225) 765-6565",website:"https://ololrmc.com",services:["Emergency","Cardiology","Oncology","Neurology","Surgery"]},{id:"baton-rouge-general",name:"Baton Rouge General Medical Center",address:"8585 Picardy Ave, Baton Rouge, LA 70809",coordinates:{lat:30.3668,lng:-91.0615},type:"general",phone:"(225) 387-7000",website:"https://brgeneral.org",services:["Emergency","Cardiology","Orthopedics","Women's Health"]},{id:"baton-rouge-general-bluebonnet",name:"Baton Rouge General Medical Center - Bluebonnet",address:"18790 Perkins Rd, Baton Rouge, LA 70810",coordinates:{lat:30.3668,lng:-91.0615},type:"general",phone:"(225) 763-4000",website:"https://brgeneral.org",services:["Emergency","Surgery","Imaging","Laboratory"]},{id:"womans-hospital",name:"Woman's Hospital",address:"100 Woman's Way, Baton Rouge, LA 70817",coordinates:{lat:30.3668,lng:-91.0615},type:"specialty",phone:"(225) 927-1300",website:"https://womans.org",services:["Maternity","Women's Health","NICU","Gynecology"]},{id:"lane-regional",name:"Lane Regional Medical Center",address:"6300 Main St, Zachary, LA 70791",coordinates:{lat:30.6479,lng:-91.1565},type:"general",phone:"(225) 658-4000",website:"https://laneregional.org",services:["Emergency","Surgery","Cardiology","Rehabilitation"]},{id:"st-elizabeth-hospital",name:"St. Elizabeth Hospital",address:"1125 W Highway 30, Gonzales, LA 70737",coordinates:{lat:30.2266,lng:-90.9204},type:"general",phone:"(225) 647-5000",website:"https://steh.com",services:["Emergency","Surgery","Cardiology","Orthopedics"]},{id:"ochsner-baton-rouge",name:"Ochsner Medical Center - Baton Rouge",address:"17000 Medical Center Dr, Baton Rouge, LA 70816",coordinates:{lat:30.3668,lng:-91.0615},type:"general",phone:"(225) 752-2470",website:"https://ochsner.org",services:["Emergency","Cardiology","Oncology","Surgery","Neurology"]},{id:"spine-hospital",name:"The Spine Hospital of Louisiana",address:"10105 Park Rowe Ave, Baton Rouge, LA 70810",coordinates:{lat:30.3668,lng:-91.0615},type:"specialty",phone:"(225) 769-2200",website:"https://thespinehospitaloflousiana.com",services:["Spine Surgery","Orthopedics","Pain Management","Rehabilitation"]},{id:"cardiovascular-institute",name:"Cardiovascular Institute of the South",address:"7941 Picardy Ave, Baton Rouge, LA 70809",coordinates:{lat:30.3668,lng:-91.0615},type:"specialty",phone:"(225) 308-0247",website:"https://cardio.com",services:["Cardiology","Cardiac Surgery","Vascular Surgery","Interventional Cardiology"]},{id:"mary-bird-perkins",name:"Mary Bird Perkins Cancer Center",address:"4950 Essen Ln, Baton Rouge, LA 70809",coordinates:{lat:30.3668,lng:-91.0615},type:"specialty",phone:"(225) 767-0847",website:"https://marybird.org",services:["Oncology","Radiation Therapy","Chemotherapy","Cancer Surgery"]}];let HospitalProximityService=class HospitalProximityService{static async calculateAllHospitalDistances(e){let t=[];for(let a of n)try{let r=await calculateDistance(e,a.coordinates);r&&t.push({hospital_id:a.id,hospital_name:a.name,distance_miles:r.distance_miles,drive_time_minutes:r.drive_time_minutes,hospital_type:a.type})}catch(e){console.error(`Error calculating distance to ${a.name}:`,e)}return t.sort((e,t)=>e.distance_miles-t.distance_miles)}static async calculateSpecificHospitalDistances(e,t){let a=[];for(let r of t){let t=n.find(e=>e.id===r);if(t)try{let r=await calculateDistance(e,t.coordinates);r&&a.push({hospital_id:t.id,hospital_name:t.name,distance_miles:r.distance_miles,drive_time_minutes:r.drive_time_minutes,hospital_type:t.type})}catch(e){console.error(`Error calculating distance to ${t.name}:`,e)}}return a.sort((e,t)=>e.distance_miles-t.distance_miles)}static formatForDatabase(e){let t={};return e.forEach(e=>{t[e.hospital_id]={distance_miles:e.distance_miles,drive_time_minutes:e.drive_time_minutes,hospital_name:e.hospital_name,hospital_type:e.hospital_type}}),t}static getClosestByType(e,t,a=3){return e.filter(e=>e.hospital_type===t).slice(0,a)}static getHospitalsWithinDistance(e,t){return e.filter(e=>e.distance_miles<=t)}static getHospitalsWithinDriveTime(e,t){return e.filter(e=>e.drive_time_minutes<=t)}static calculateAverageDistance(e){if(0===e.length)return{averageDistance:0,averageDriveTime:0};let t=e.reduce((e,t)=>e+t.distance_miles,0),a=e.reduce((e,t)=>e+t.drive_time_minutes,0);return{averageDistance:t/e.length,averageDriveTime:a/e.length}}static getProximitySummary(e){let t=e.length>0?e[0]:null,a=this.getClosestByType(e,"general",3),r=this.getClosestByType(e,"specialty",3),i=this.getHospitalsWithinDistance(e,5).length,s=this.getHospitalsWithinDistance(e,10).length;return{closest:t,generalHospitals:a,specialtyHospitals:r,within5Miles:i,within10Miles:s}}};let GeocodingService=class GeocodingService{static async geocodeAddress(e){try{let t=await geocodeAddress(e);return t}catch(e){return console.error("Geocoding service error:",e),null}}static isInBatonRougeArea(e,t){let a={north:30.6,south:30.3,east:-90.9,west:-91.3};return e>=a.south&&e<=a.north&&t>=a.west&&t<=a.east}static formatAddress(e){return e.split(",").map(e=>e.trim()).filter(e=>e.length>0).join(", ")}static extractCityState(e){let t=e.split(",").map(e=>e.trim());for(let e=0;e<t.length-1;e++){let a=t[e],r=t[e+1];if(r.match(/^[A-Z]{2}(\s+\d{5})?$/))return{city:a,state:r.split(" ")[0]}}return{city:"",state:""}}};let PropertyService=class PropertyService{getSupabase(){return(0,r.j)()}async createProperty(e,t){let a={title:e.title,description:e.description||null,address:e.address,amenities:e.amenities,base_price:e.base_price,max_guests:e.max_guests,bedrooms:e.bedrooms||null,bathrooms:e.bathrooms||null,images:e.images,hospital_distances:e.hospital_distances||null,is_active:e.is_active,owner_id:t},{data:r,error:i}=await this.getSupabase().from("properties").insert(a).select().single();if(i)throw Error(`Failed to create property: ${i.message}`);return r}async getProperty(e,t){let a=this.getSupabase().from("properties").select("*").eq("id",e);t&&(a=a.eq("owner_id",t));let{data:r,error:i}=await a.single();if(i){if("PGRST116"===i.code)return null;throw Error(`Failed to get property: ${i.message}`)}return r}async getProperties(e,t){let a=e.page||1,r=e.limit||10,i=(a-1)*r,s=this.getSupabase().from("properties").select("*",{count:"exact"});t&&(s=s.eq("owner_id",t)),e.search&&(s=s.or(`title.ilike.%${e.search}%,description.ilike.%${e.search}%`)),void 0!==e.is_active&&(s=s.eq("is_active",e.is_active));let o=e.sort_by||"created_at",n=e.sort_order||"desc";s=(s=s.order(o,{ascending:"asc"===n})).range(i,i+r-1);let{data:l,error:c,count:d}=await s;if(c)throw Error(`Failed to get properties: ${c.message}`);return{properties:l||[],total:d||0,page:a,limit:r}}async updateProperty(e,t){let{id:a,...r}=e,i={...r.title&&{title:r.title},...void 0!==r.description&&{description:r.description},...r.address&&{address:r.address},...r.amenities&&{amenities:r.amenities},...r.base_price&&{base_price:r.base_price},...r.max_guests&&{max_guests:r.max_guests},...void 0!==r.bedrooms&&{bedrooms:r.bedrooms},...void 0!==r.bathrooms&&{bathrooms:r.bathrooms},...r.images&&{images:r.images},...r.hospital_distances&&{hospital_distances:r.hospital_distances},...void 0!==r.is_active&&{is_active:r.is_active},updated_at:new Date().toISOString()},{data:s,error:o}=await this.getSupabase().from("properties").update(i).eq("id",a).eq("owner_id",t).select().single();if(o){if("PGRST116"===o.code)throw Error("Property not found or you do not have permission to update it");throw Error(`Failed to update property: ${o.message}`)}return s}async deleteProperty(e,t){let{error:a}=await this.getSupabase().from("properties").delete().eq("id",e).eq("owner_id",t);if(a)throw Error(`Failed to delete property: ${a.message}`)}async uploadPropertyImage(e,t,a){let r=await this.getProperty(t,a);if(!r)throw Error("Property not found or you do not have permission to upload images");let i=e.name.split(".").pop(),s=`${t}/${Date.now()}.${i}`,{data:o,error:n}=await this.getSupabase().storage.from("property-images").upload(s,e,{cacheControl:"3600",upsert:!1});if(n)throw Error(`Failed to upload image: ${n.message}`);let{data:{publicUrl:l}}=this.getSupabase().storage.from("property-images").getPublicUrl(o.path);return l}async deletePropertyImage(e,t,a){let r=await this.getProperty(t,a);if(!r)throw Error("Property not found or you do not have permission to delete images");let i=e.includes("/")?e.split("/").pop():e,{error:s}=await this.getSupabase().storage.from("property-images").remove([`${t}/${i}`]);if(s)throw Error(`Failed to delete image: ${s.message}`)}async calculateHospitalProximity(e,t){let a=await this.getProperty(e,t);if(!a)throw Error("Property not found or you do not have permission to access it");let r=null;if(a.address&&"object"==typeof a.address){let e=a.address;e.coordinates&&(r=e.coordinates)}if(!r&&a.address){let e="string"==typeof a.address?a.address:a.address.street||"";if(e){let t=await GeocodingService.geocodeAddress(e);t&&(r={lat:t.lat,lng:t.lng})}}if(!r)throw Error("Unable to determine property coordinates for hospital proximity calculation");let i=await HospitalProximityService.calculateAllHospitalDistances(r),s=HospitalProximityService.formatForDatabase(i);return await this.updateProperty({id:e,hospital_distances:s},t),s}async getHospitalProximity(e,t){let a=await this.getProperty(e,t);return a&&a.hospital_distances?a.hospital_distances:null}async refreshAllHospitalProximity(e){let{properties:t}=await this.getProperties({page:1,limit:100},e);for(let a of t)try{await this.calculateHospitalProximity(a.id,e)}catch(e){console.error(`Failed to update hospital proximity for property ${a.id}:`,e)}}};let l=new PropertyService},699:(e,t,a)=>{"use strict";a.d(t,{j:()=>createSupabaseServerClient});var r=a(6813),i=a(4596);let createSupabaseServerClient=()=>(0,r.createServerComponentClient)({cookies:i.cookies})}};